# Operit AI é¡¹ç›®æ¶æ„è¯¦è§£

> ğŸ¯ æœ¬æ–‡æ¡£å¸®åŠ© Compose å’Œ Kotlin æ–°æ‰‹å¿«é€Ÿç†è§£ Operit AI é¡¹ç›®çš„è®¾è®¡ã€æ¶æ„å’ŒåŸç†

------

## ğŸ“± é¡¹ç›®ç®€ä»‹

**Operit AI** æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç§»åŠ¨ç«¯ AI æ™ºèƒ½åŠ©æ‰‹åº”ç”¨ï¼Œè¿è¡Œåœ¨ Android è®¾å¤‡ä¸Šã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„èŠå¤©åº”ç”¨ï¼Œè€Œæ˜¯ä¸€ä¸ªæ·±åº¦é›†æˆäº† **å·¥å…·è°ƒç”¨èƒ½åŠ›**ã€**Linux ç»ˆç«¯**ã€**MCP åè®®**ã€**æœ¬åœ° AI æ¨¡å‹** ç­‰åŠŸèƒ½çš„å…¨èƒ½åŠ©æ‰‹ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ¤– **å¤šæ¨¡å‹æ”¯æŒ**: OpenAIã€Claudeã€Geminiã€DeepSeekã€æœ¬åœ° MNN æ¨¡å‹ç­‰
- ğŸ› ï¸ **å·¥å…·è°ƒç”¨**: 40+ å†…ç½®å·¥å…·ï¼Œæ”¯æŒæ–‡ä»¶æ“ä½œã€ç½‘ç»œè¯·æ±‚ã€ç³»ç»Ÿæ§åˆ¶ç­‰
- ğŸ§ **å†…ç½® Ubuntu**: å®Œæ•´çš„ Linux ç»ˆç«¯ç¯å¢ƒ
- ğŸ”Œ **MCP æ’ä»¶**: æ”¯æŒ Model Context Protocol æ‰©å±•
- ğŸ­ **äººè®¾è§’è‰²å¡**: è‡ªå®šä¹‰ AI æ€§æ ¼å’Œå¯¹è¯é£æ ¼
- ğŸ§  **æ™ºèƒ½è®°å¿†**: AI è‡ªåŠ¨åˆ†ç±»ç®¡ç†ç”¨æˆ·åå¥½

------

## ğŸ—ï¸ é¡¹ç›®ç»“æ„æ€»è§ˆ

```
Operit/

â”œâ”€â”€ app/                    # ä¸»åº”ç”¨æ¨¡å— (æ ¸å¿ƒä»£ç )

â”œâ”€â”€ dragonbones/           # éª¨éª¼åŠ¨ç”»åº“ (æ¡Œå® åŠ¨ç”»)

â”œâ”€â”€ terminal/              # Linux ç»ˆç«¯æ¨¡å—

â”œâ”€â”€ mnn/                   # MNN æœ¬åœ° AI æ¨¡å‹æ¨¡å—

â”œâ”€â”€ llama/                 # Llama æœ¬åœ°æ¨¡å‹æ¨¡å—

â”œâ”€â”€ showerclient/          # è¿œç¨‹å®¢æˆ·ç«¯æ¨¡å—

â”œâ”€â”€ tools/                 # å¼€å‘å·¥å…·å’Œè¾…åŠ©è„šæœ¬

â”œâ”€â”€ examples/              # ç¤ºä¾‹è„šæœ¬å’Œé…ç½®

â””â”€â”€ docs/                  # é¡¹ç›®æ–‡æ¡£
```

### æ¨¡å—èŒè´£

| æ¨¡å—           | ç”¨é€”                                | æŠ€æœ¯æ ˆ                   |
| :------------- | :---------------------------------- | :----------------------- |
| app            | ä¸»åº”ç”¨ï¼ŒåŒ…å« UIã€ä¸šåŠ¡é€»è¾‘ã€æ ¸å¿ƒåŠŸèƒ½ | Kotlin + Jetpack Compose |
| `dragonbones`  | 2D éª¨éª¼åŠ¨ç”»æ¸²æŸ“ï¼Œç”¨äºæ¡Œå® åŠŸèƒ½       | Kotlin                   |
| `terminal`     | Linux ç»ˆç«¯ç¯å¢ƒï¼Œproot å®¹å™¨          | Native C/C++             |
| `mnn`          | é˜¿é‡Œ MNN æ·±åº¦å­¦ä¹ æ¡†æ¶               | C++ + JNI                |
| `llama`        | Llama.cpp æœ¬åœ°å¤§æ¨¡å‹                | C++ + JNI                |
| `showerclient` | è¿œç¨‹è¿æ¥å®¢æˆ·ç«¯                      | Kotlin                   |

------

## ğŸ“¦ ä¸»åº”ç”¨æ¶æ„ (app æ¨¡å—)

ä¸»åº”ç”¨ä½äº `app/src/main/java/com/ai/assistance/operit/`ï¼Œé‡‡ç”¨ç»å…¸çš„åˆ†å±‚æ¶æ„ï¼š

```
operit/

â”œâ”€â”€ api/                # API å±‚ - ä¸å¤–éƒ¨æœåŠ¡äº¤äº’

â”‚   â”œâ”€â”€ chat/          # AI å¯¹è¯ç›¸å…³ API

â”‚   â”œâ”€â”€ speech/        # è¯­éŸ³æœåŠ¡ API  

â”‚   â””â”€â”€ voice/         # è¯­éŸ³è¯†åˆ« API

â”‚

â”œâ”€â”€ core/              # æ ¸å¿ƒå±‚ - ä¸šåŠ¡æ ¸å¿ƒé€»è¾‘

â”‚   â”œâ”€â”€ chat/         # å¯¹è¯ç®¡ç†æ ¸å¿ƒ

â”‚   â”œâ”€â”€ tools/        # å·¥å…·ç³»ç»Ÿæ ¸å¿ƒ

â”‚   â”œâ”€â”€ workflow/     # å·¥ä½œæµå¼•æ“

â”‚   â”œâ”€â”€ avatar/       # å¤´åƒ/è§’è‰²ç³»ç»Ÿ

â”‚   â””â”€â”€ config/       # é…ç½®ç®¡ç†

â”‚

â”œâ”€â”€ data/              # æ•°æ®å±‚ - æ•°æ®å­˜å‚¨ä¸ç®¡ç†

â”‚   â”œâ”€â”€ model/        # æ•°æ®æ¨¡å‹å®šä¹‰

â”‚   â”œâ”€â”€ dao/          # æ•°æ®è®¿é—®å¯¹è±¡

â”‚   â”œâ”€â”€ repository/   # æ•°æ®ä»“åº“

â”‚   â”œâ”€â”€ preferences/  # åå¥½è®¾ç½®ç®¡ç†

â”‚   â””â”€â”€ mcp/          # MCP æ•°æ®ç®¡ç†

â”‚

â”œâ”€â”€ ui/                # UI å±‚ - ç•Œé¢å±•ç¤º

â”‚   â”œâ”€â”€ features/     # åŠŸèƒ½æ¨¡å— UI

â”‚   â”œâ”€â”€ main/         # ä¸»ç•Œé¢

â”‚   â”œâ”€â”€ floating/     # æ‚¬æµ®çª—

â”‚   â”œâ”€â”€ theme/        # ä¸»é¢˜æ ·å¼

â”‚   â””â”€â”€ components/   # é€šç”¨ç»„ä»¶

â”‚

â”œâ”€â”€ services/          # æœåŠ¡å±‚ - åå°æœåŠ¡

â”‚   â”œâ”€â”€ core/         # æ ¸å¿ƒæœåŠ¡

â”‚   â””â”€â”€ floating/     # æ‚¬æµ®çª—æœåŠ¡

â”‚

â””â”€â”€ util/              # å·¥å…·ç±»
```

------

## ğŸ¨ UI å±‚è¯¦è§£ (Jetpack Compose)

### ä»€ä¹ˆæ˜¯ Jetpack Composeï¼Ÿ

Jetpack Compose æ˜¯ Google æ¨å‡ºçš„ç°ä»£ Android UI å·¥å…·åŒ…ï¼Œä½¿ç”¨**å£°æ˜å¼**æ–¹å¼æ„å»ºç•Œé¢ã€‚

#### ä¼ ç»Ÿ View vs Compose å¯¹æ¯”

```
// ä¼ ç»Ÿ View æ–¹å¼ (å‘½ä»¤å¼)

textView.text = "Hello"

textView.setTextColor(Color.RED)



// Compose æ–¹å¼ (å£°æ˜å¼)

@Composable

fun Greeting() {

    Text(

        text = "Hello",

        color = Color.Red

    )

}
```

### UI ç›®å½•ç»“æ„

```
ui/

â”œâ”€â”€ features/           # åŠŸèƒ½æ¨¡å— (æŒ‰ä¸šåŠ¡åˆ’åˆ†)

â”‚   â”œâ”€â”€ chat/          # ğŸ’¬ èŠå¤©åŠŸèƒ½ (æœ€æ ¸å¿ƒ)

â”‚   â”‚   â”œâ”€â”€ components/   # èŠå¤© UI ç»„ä»¶

â”‚   â”‚   â”œâ”€â”€ viewmodel/    # ChatViewModel

â”‚   â”‚   â””â”€â”€ screens/      # èŠå¤©å±å¹•

â”‚   â”‚

â”‚   â”œâ”€â”€ settings/      # âš™ï¸ è®¾ç½®åŠŸèƒ½

â”‚   â”œâ”€â”€ packages/      # ğŸ“¦ æ’ä»¶å¸‚åœº

â”‚   â”œâ”€â”€ memory/        # ğŸ§  è®°å¿†ç®¡ç†

â”‚   â”œâ”€â”€ workflow/      # ğŸ”„ å·¥ä½œæµ

â”‚   â”œâ”€â”€ toolbox/       # ğŸ§° å·¥å…·ç®±

â”‚   â””â”€â”€ assistant/     # ğŸ¤– åŠ©æ‰‹é…ç½®

â”‚

â”œâ”€â”€ main/              # ä¸»ç•Œé¢

â”‚   â””â”€â”€ MainActivity.kt  # åº”ç”¨å…¥å£ Activity

â”‚

â”œâ”€â”€ floating/          # æ‚¬æµ®çª—ç•Œé¢

â”‚   â”œâ”€â”€ FloatingMode.kt

â”‚   â””â”€â”€ ui/

â”‚

â”œâ”€â”€ theme/             # ä¸»é¢˜å®šä¹‰

â”‚   â””â”€â”€ Theme.kt       # Material3 ä¸»é¢˜

â”‚

â””â”€â”€ components/        # é€šç”¨ UI ç»„ä»¶
```

### MVVM æ¶æ„æ¨¡å¼

é¡¹ç›®ä½¿ç”¨ **MVVM (Model-View-ViewModel)** æ¶æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                        View (UI)                             â”‚

â”‚  Composable å‡½æ•°ï¼Œè´Ÿè´£æ˜¾ç¤ºç•Œé¢ï¼Œå“åº”ç”¨æˆ·äº¤äº’                    â”‚

â”‚  ä¾‹: ChatScreen.kt, MessageBubble.kt                        â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â†•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                     ViewModel                                â”‚

â”‚  ç®¡ç† UI çŠ¶æ€ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œè°ƒç”¨ Repository                   â”‚

â”‚  ä¾‹: ChatViewModel.kt (2142è¡Œï¼ŒåŠŸèƒ½éå¸¸ä¸°å¯Œ)                  â”‚

â”‚  - ç®¡ç†èŠå¤©æ¶ˆæ¯çŠ¶æ€                                           â”‚

â”‚  - å¤„ç†ç”¨æˆ·è¾“å…¥                                              â”‚

â”‚  - è°ƒç”¨ AI æœåŠ¡                                              â”‚

â”‚  - ç®¡ç†é™„ä»¶ã€è¯­éŸ³ç­‰                                           â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â†•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                    Model (Data Layer)                        â”‚

â”‚  æ•°æ®æ¨¡å‹ã€Repositoryã€æ•°æ®æº                                 â”‚

â”‚  ä¾‹: ChatMessage.kt, ChatRepository.kt                      â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒ ViewModel ç¤ºä¾‹



ChatViewModel.kt æ˜¯æœ€æ ¸å¿ƒçš„ ViewModelï¼ŒåŒ…å«ï¼š



```
// ä¸»è¦åŠŸèƒ½

class ChatViewModel : ViewModel() {

    // æ¶ˆæ¯ç®¡ç†

    fun sendMessage(content: String)

    fun handleSharedLinks(urls: List<String>)

    

    // API é…ç½®

    fun updateApiKey(key: String)

    fun updateModelName(modelName: String)

    

    // AI åŠŸèƒ½å¼€å…³

    fun toggleAiPlanning()

    fun toggleThinkingMode()

    fun toggleMemoryQuery()

    

    // ä¸Šä¸‹æ–‡ç®¡ç†

    fun updateContextLength(length: Float)

    

    // è¯­éŸ³åŠŸèƒ½

    // é™„ä»¶ç®¡ç†

    // ...ç­‰ 116+ ä¸ªæ–¹æ³•

}
```

------

## ğŸ¤– AI æœåŠ¡å±‚è¯¦è§£

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                    ChatViewModel                             â”‚

â”‚                    (UI å±‚å…¥å£)                               â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                  EnhancedAIService                           â”‚

â”‚                  (å¢å¼º AI æœåŠ¡)                              â”‚

â”‚  - å·¥å…·è°ƒç”¨é›†æˆ                                              â”‚

â”‚  - å¯¹è¯ç®¡ç†                                                  â”‚

â”‚  - ç”¨æˆ·åå¥½                                                  â”‚

â”‚  - è®°å¿†åº“                                                    â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                  AIServiceFactory                            â”‚

â”‚                  (å·¥å‚æ¨¡å¼)                                   â”‚

â”‚  æ ¹æ®é…ç½®åˆ›å»ºå…·ä½“çš„ Provider å®ä¾‹                             â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                  LLM Providers                               â”‚

â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚

â”‚  â”‚ OpenAI     â”‚ â”‚ Claude      â”‚ â”‚ Gemini      â”‚           â”‚

â”‚  â”‚ Provider   â”‚ â”‚ Provider    â”‚ â”‚ Provider    â”‚           â”‚

â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚

â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚

â”‚  â”‚ DeepSeek   â”‚ â”‚ MNN         â”‚ â”‚ Llama       â”‚           â”‚

â”‚  â”‚ Provider   â”‚ â”‚ Provider    â”‚ â”‚ Provider    â”‚           â”‚

â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Provider å®ç°

æ¯ä¸ª AI æä¾›å•†éƒ½æœ‰ç‹¬ç«‹çš„ Provider ç±»ï¼š

| Provider | æ–‡ä»¶                       | åŠŸèƒ½             |
| :------- | :------------------------- | :--------------- |
| OpenAI   | `OpenAIProvider.kt` (79KB) | GPT ç³»åˆ—æ¨¡å‹     |
| Claude   | `ClaudeProvider.kt` (64KB) | Anthropic Claude |
| Gemini   | `GeminiProvider.kt` (70KB) | Google Gemini    |
| MNN      | `MNNProvider.kt` (38KB)    | æœ¬åœ° MNN æ¨¡å‹    |
| Llama    | `LlamaProvider.kt` (10KB)  | æœ¬åœ° Llama æ¨¡å‹  |

------

## ğŸ› ï¸ å·¥å…·ç³»ç»Ÿè¯¦è§£

### å·¥å…·ç³»ç»Ÿæ¶æ„

```
core/tools/

â”œâ”€â”€ AIToolHandler.kt         # å·¥å…·è°ƒç”¨å¤„ç†å™¨

â”œâ”€â”€ ToolRegistration.kt      # å·¥å…·æ³¨å†Œ (1413è¡Œï¼Œæ³¨å†Œ40+å·¥å…·)

â”œâ”€â”€ ToolPackage.kt           # å·¥å…·åŒ…ç®¡ç†

â”œâ”€â”€ ToolProgressBus.kt       # å·¥å…·æ‰§è¡Œè¿›åº¦æ€»çº¿

â”‚

â”œâ”€â”€ defaultTool/             # é»˜è®¤å·¥å…·å®ç°

â”‚   â”œâ”€â”€ standard/           # æ ‡å‡†å·¥å…· (æ— éœ€ç‰¹æ®Šæƒé™)

â”‚   â”œâ”€â”€ accessbility/       # æ— éšœç¢æœåŠ¡å·¥å…·

â”‚   â”œâ”€â”€ admin/              # ç®¡ç†å‘˜å·¥å…·

â”‚   â”œâ”€â”€ root/               # Root æƒé™å·¥å…·

â”‚   â””â”€â”€ debugger/           # è°ƒè¯•å·¥å…·

â”‚

â”œâ”€â”€ system/                  # ç³»ç»Ÿçº§å·¥å…·

â”‚   â””â”€â”€ Terminal.kt         # ç»ˆç«¯å‘½ä»¤æ‰§è¡Œ

â”‚

â”œâ”€â”€ mcp/                     # MCP åè®®å·¥å…·

â”‚   â””â”€â”€ MCPToolBridge.kt    # MCP å·¥å…·æ¡¥æ¥

â”‚

â”œâ”€â”€ javascript/              # JavaScript è„šæœ¬å·¥å…·

â”‚   â””â”€â”€ JSToolExecutor.kt   # JS æ‰§è¡Œå™¨

â”‚

â””â”€â”€ agent/                   # Agent å·¥å…·
```

### å·¥å…·æ³¨å†Œæœºåˆ¶



ToolRegistration.kt æ˜¯å·¥å…·æ³¨å†Œçš„æ ¸å¿ƒï¼š



```
// å·¥å…·æ³¨å†Œç¤ºä¾‹

fun registerAllTools(handler: AIToolHandler, context: Context) {

    // æ–‡ä»¶å·¥å…·

    handler.register("read_file") { tool ->

        // å®ç°è¯»å–æ–‡ä»¶é€»è¾‘

    }

    

    // ç½‘ç»œå·¥å…·

    handler.register("http_request") { tool ->

        // å®ç° HTTP è¯·æ±‚

    }

    

    // ç»ˆç«¯å·¥å…·

    handler.register("execute_command") { tool ->

        // æ‰§è¡Œ Linux å‘½ä»¤

    }

    

    // ... 40+ å·¥å…·

}
```

### æƒé™åˆ†çº§å·¥å…·

å·¥å…·æŒ‰æƒé™çº§åˆ«åˆ†ç±»ï¼š

| çº§åˆ«          | ç›®å½•            | è¯´æ˜                     |
| :------------ | :-------------- | :----------------------- |
| Standard      | `standard/`     | æ— éœ€ç‰¹æ®Šæƒé™ï¼Œå¦‚æ–‡ä»¶è¯»å†™ |
| Accessibility | `accessbility/` | éœ€è¦æ— éšœç¢æœåŠ¡æƒé™       |
| Admin         | `admin/`        | éœ€è¦è®¾å¤‡ç®¡ç†å‘˜æƒé™       |
| Root          | `root/`         | éœ€è¦ Root æƒé™           |

------

## ğŸ’¾ æ•°æ®å±‚è¯¦è§£

### æ•°æ®æ¨¡å‹ (data/model/)

æ ¸å¿ƒæ•°æ®æ¨¡å‹å®šä¹‰ï¼š

```
// èŠå¤©æ¶ˆæ¯

data class ChatMessage(

    val id: String,

    val content: String,

    val role: MessageRole,

    val timestamp: Long

)



// AI å·¥å…·

data class AITool(

    val name: String,

    val description: String,

    val parameters: Map<String, Any>

)



// è§’è‰²å¡

data class CharacterCard(

    val name: String,

    val description: String,

    val systemPrompt: String

)



// è®°å¿†

data class Memory(

    val id: Long,

    val content: String,

    val category: String,

    val embedding: FloatArray

)
```

### æ•°æ®å­˜å‚¨æŠ€æœ¯

| æŠ€æœ¯                  | ç”¨é€”                             |
| :-------------------- | :------------------------------- |
| **ObjectBox**         | ä¸»è¦æ•°æ®åº“ï¼Œå­˜å‚¨èŠå¤©è®°å½•ã€è®°å¿†ç­‰ |
| **Room**              | éƒ¨åˆ†æœ¬åœ°æ•°æ®å­˜å‚¨                 |
| **DataStore**         | åå¥½è®¾ç½®å­˜å‚¨                     |
| **SharedPreferences** | ç®€å•é…ç½®å­˜å‚¨                     |

### Repository æ¨¡å¼

```
// æ•°æ®ä»“åº“æ¨¡å¼ç¤ºä¾‹

class ChatRepository(

    private val chatDao: ChatDao,

    private val messageDao: MessageDao

) {

    // è·å–èŠå¤©å†å²

    suspend fun getChatHistory(chatId: String): List<ChatMessage>

    

    // ä¿å­˜æ¶ˆæ¯

    suspend fun saveMessage(message: ChatMessage)

    

    // åˆ é™¤èŠå¤©

    suspend fun deleteChat(chatId: String)

}
```

------

## ğŸ”Œ MCP åè®®æ”¯æŒ

**Model Context Protocol (MCP)** æ˜¯ä¸€ç§æ‰©å±• AI èƒ½åŠ›çš„æ ‡å‡†åè®®ã€‚

### MCP æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

â”‚                      Operit AI App                           â”‚

â”‚                                                              â”‚

â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚

â”‚  â”‚                 MCP Client                            â”‚   â”‚

â”‚  â”‚  - ç®¡ç† MCP æœåŠ¡å™¨è¿æ¥                                â”‚   â”‚

â”‚  â”‚  - è°ƒç”¨è¿œç¨‹å·¥å…·                                       â”‚   â”‚

â”‚  â”‚  - å¤„ç†ç»“æœ                                           â”‚   â”‚

â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚

â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â†•

         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”

         â†“                    â†“                    â†“

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”

    â”‚ MCP     â”‚         â”‚ MCP     â”‚         â”‚ MCP     â”‚

    â”‚ Server  â”‚         â”‚ Server  â”‚         â”‚ Server  â”‚

    â”‚ (Web)   â”‚         â”‚ (File)  â”‚         â”‚ (API)   â”‚

    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MCP ç›¸å…³ä»£ç 

```
data/mcp/

â”œâ”€â”€ MCPRepository.kt        # MCP æ•°æ®ä»“åº“

â”œâ”€â”€ MCPServerConfig.kt      # æœåŠ¡å™¨é…ç½®

â””â”€â”€ MCPMarketItem.kt        # å¸‚åœºæ’ä»¶é¡¹



core/tools/mcp/

â”œâ”€â”€ MCPToolBridge.kt        # MCP å·¥å…·æ¡¥æ¥

â”œâ”€â”€ MCPClientManager.kt     # å®¢æˆ·ç«¯ç®¡ç†

â””â”€â”€ MCPProtocolHandler.kt   # åè®®å¤„ç†
```

------

## ğŸš€ æ ¸å¿ƒæŠ€æœ¯æ ˆ

| ç±»åˆ«         | æŠ€æœ¯                  | ç”¨é€”       |
| :----------- | :-------------------- | :--------- |
| **è¯­è¨€**     | Kotlin 1.9            | ä¸»å¼€å‘è¯­è¨€ |
| **UI æ¡†æ¶**  | Jetpack Compose       | å£°æ˜å¼ UI  |
| **æ¶æ„**     | MVVM                  | ä»£ç ç»„ç»‡   |
| **ä¾èµ–æ³¨å…¥** | æ‰‹åŠ¨ + å•ä¾‹           | å¯¹è±¡ç®¡ç†   |
| **å¼‚æ­¥**     | Kotlin Coroutines     | å¼‚æ­¥æ“ä½œ   |
| **ç½‘ç»œ**     | OkHttp + Retrofit     | HTTP è¯·æ±‚  |
| **åºåˆ—åŒ–**   | Kotlinx Serialization | JSON è§£æ  |
| **æ•°æ®åº“**   | ObjectBox + Room      | æœ¬åœ°å­˜å‚¨   |
| **AI**       | MNN + Llama.cpp       | æœ¬åœ°æ¨¡å‹   |
| **ç»ˆç«¯**     | proot                 | Linux ç¯å¢ƒ |

------

## ğŸ“Š é¡¹ç›®è§„æ¨¡

| æŒ‡æ ‡           | æ•°é‡  |
| :------------- | :---- |
| ä¸»æ¨¡å—ä»£ç æ–‡ä»¶ | 900+  |
| å­æ¨¡å—         | 5 ä¸ª  |
| ViewModel ç±»   | 19 ä¸ª |
| AI Provider    | 7 ä¸ª  |
| å†…ç½®å·¥å…·       | 40+   |
| ä¾èµ–åº“         | 80+   |

------

## ğŸ¯ å­¦ä¹ å»ºè®®

### åˆå­¦è€…è·¯çº¿

1. **å…ˆç†è§£ Compose åŸºç¡€**

   - å­¦ä¹  `@Composable` å‡½æ•°
   - ç†è§£ `remember` å’Œ `State`
   - ç†Ÿæ‚‰ Material3 ç»„ä»¶

2. **ä» UI å±‚å¼€å§‹**

   - é˜…è¯»

      

     MainActivity.kt

   - æ¢ç´¢ `ui/features/chat/` ç›®å½•

3. **ç†è§£ MVVM**

   - åˆ†æ ChatViewModel çš„ç»“æ„
   - ç†è§£ StateFlow å’Œ collectAsState

4. **æ·±å…¥æ ¸å¿ƒå±‚**

   - å­¦ä¹  EnhancedAIService
   - ç†è§£å·¥å…·æ³¨å†Œæœºåˆ¶

### æ¨èé˜…è¯»é¡ºåº

```
1. MainActivity.kt (å…¥å£)

           â†“

2. ChatScreen.kt (èŠå¤©ç•Œé¢)

           â†“

3. ChatViewModel.kt (ä¸šåŠ¡é€»è¾‘)

           â†“

4. EnhancedAIService.kt (AI æœåŠ¡)

           â†“

5. ToolRegistration.kt (å·¥å…·ç³»ç»Ÿ)

           â†“

6. å„ Provider å®ç°
```

------

## ğŸ“š ç›¸å…³æ–‡æ¡£

- å¼€æºå…±åˆ›æŒ‡å—
- è„šæœ¬å¼€å‘æŒ‡å—
- ç¼–è¯‘æŒ‡å—

------

> ğŸ’¡ **æç¤º**: è¿™ä¸ªé¡¹ç›®éå¸¸åºå¤§ï¼Œå»ºè®®é€æ­¥å­¦ä¹ ï¼Œå…ˆä» UI å±‚å…¥æ‰‹ï¼Œå†æ·±å…¥åˆ°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€‚å¦‚æœæœ‰å…·ä½“é—®é¢˜ï¼Œéšæ—¶å¯ä»¥é—®æˆ‘ï¼